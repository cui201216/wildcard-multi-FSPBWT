
# wild-multi-FSPBWT

**wild-multi-FSPBWT** æ˜¯ä¸€ä¸ªé«˜æ•ˆçš„å•å€å‹é•¿ç‰‡æ®µåŒ¹é…ï¼ˆHaplotype Long Match Queryï¼‰å·¥å…·ã€‚è¯¥é¡¹ç›®åŸºäº **Fuzzy Syllable PBWT (FSPBWT)** ç®—æ³•ï¼Œå¹¶åœ¨å…¶åŸºç¡€ä¸Šè¿›è¡Œäº†æ‰©å±•ï¼Œä½¿å…¶èƒ½å¤ŸåŸç”Ÿæ”¯æŒ **ç¼ºå¤±å€¼ï¼ˆWildcards/Missing Valuesï¼‰** å’Œ **å¤šç­‰ä½åŸºå› ï¼ˆMulti-allelic variantsï¼‰** çš„å¤„ç†ã€‚

æœ¬é¡¹ç›®é€‚ç”¨äºç”Ÿç‰©ä¿¡æ¯å­¦é¢†åŸŸçš„å¤§è§„æ¨¡ç¾¤ä½“é—ä¼ æ•°æ®åˆ†æï¼Œæ”¯æŒ VCF å’Œ MACS æ ¼å¼æ•°æ®çš„ **In-Panel**ï¼ˆé¢æ¿å†…è‡ªæŸ¥è¯¢ï¼‰å’Œ **Out-Panel**ï¼ˆå¤–éƒ¨æŸ¥è¯¢ï¼‰æ¨¡å¼ã€‚

## âœ¨ ä¸»è¦ç‰¹æ€§

* **æ”¯æŒç¼ºå¤±å€¼ (Wildcards):** èƒ½å¤Ÿå¤„ç†æ•°æ®ä¸­çš„ç¼ºå¤±ä½ç‚¹ï¼ˆ`.`ï¼‰ï¼Œå°†å…¶è§†ä¸ºé€šé…ç¬¦å¤„ç†ã€‚
* **æ”¯æŒå¤šç­‰ä½åŸºå›  (Multi-allelic):** ä¸ä»…æ”¯æŒäºŒå€ä½“ï¼ˆ0/1ï¼‰ï¼Œè¿˜æ”¯æŒå¤šæ€æ€§ä½ç‚¹ï¼ˆ0-9ï¼‰ã€‚
* **ä¸¤ç§æŸ¥è¯¢æ¨¡å¼:**
* `in`: é¢æ¿å†…æ‰€æœ‰æ ·æœ¬çš„ä¸¤ä¸¤åŒ¹é…ï¼ˆSelf-matchingï¼‰ã€‚
* `out`: å°†å¤–éƒ¨ Query åºåˆ—ä¸ Reference Panel è¿›è¡ŒåŒ¹é…ã€‚


* **é«˜æ€§èƒ½:** ä½¿ç”¨ C++17 ç¼–å†™ï¼Œåˆ©ç”¨ä½è¿ç®—ï¼ˆæ”¯æŒ 64ä½ å’Œ 128ä½ å—å¤§å°ï¼‰åŠ é€ŸåŒ¹é…è¿‡ç¨‹ã€‚
* **æ¨¡ç³ŠåŒ¹é…ç­–ç•¥:** é€šè¿‡å¯è°ƒèŠ‚çš„  Få€¼ï¼ˆFuzzy value degreeï¼‰å’Œ  Bå€¼ï¼ˆSyllable sizeï¼‰å¹³è¡¡æŸ¥è¯¢é€Ÿåº¦ä¸çµæ•åº¦ã€‚

## ğŸ› ï¸ ä¾èµ–ä¸ç¼–è¯‘

### ä¾èµ–ç¯å¢ƒ

* **C++ ç¼–è¯‘å™¨:** æ”¯æŒ C++17 æ ‡å‡† (å¦‚ GCC 7+, Clang 5+)
* **CMake:** ç‰ˆæœ¬ >= 3.28
* **æ“ä½œç³»ç»Ÿ:** Linux  (æ¨èUbuntu)

### ç¼–è¯‘æ­¥éª¤

```bash
# 1. å…‹éš†ä»“åº“
git clone https://github.com/cui201216/wildcard-multi-FSPBWT.git
cd wildcard-multi-FSPBWT

# 2. åˆ›å»ºæ„å»ºç›®å½•
mkdir build && cd build

# 3. ç”Ÿæˆæ„å»ºæ–‡ä»¶
cmake ..

# 4. ç¼–è¯‘ (å°†ç”Ÿæˆ wild-multiFSPBWT)
make -j4

```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ç”¨æ³•

```bash
./wild-multiFSPBWT -i <panel_file> -o <output_file> [options]

```

### å‚æ•°è¯¦è§£

| å‚æ•° (Short/Long) | å¿…å¡« | é»˜è®¤å€¼ | æè¿° |
| --- | --- | --- | --- |
| `-i`, `--input` | âœ… | `panel` | è¾“å…¥çš„ Panel æ–‡ä»¶è·¯å¾„ã€‚ |
| `-o`, `--output` | âŒ | `<input>.out` | è¾“å‡ºåŒ¹é…ç»“æœçš„æ–‡ä»¶è·¯å¾„ã€‚ |
| `-q`, `--query` | âš ï¸ | - | å¤–éƒ¨æŸ¥è¯¢æ–‡ä»¶è·¯å¾„ï¼ˆä»…å½“ `-m out` æ—¶**å¿…é¡»**æŒ‡å®šï¼‰ã€‚ |
| `-m`, `--mode` | âŒ | `in` | æŸ¥è¯¢æ¨¡å¼ï¼š`in` (é¢æ¿å†…) æˆ– `out` (å¤–éƒ¨æŸ¥è¯¢)ã€‚ |
| `--macs` | âŒ | (VCF) | æŒ‡å®šè¾“å…¥æ–‡ä»¶æ ¼å¼ä¸º MACS æ ¼å¼ï¼ˆé»˜è®¤è§£æä¸º VCFï¼‰ã€‚ |
| `-B`, `--block` | âŒ | 64 | å—å¤§å° (Block size)ã€‚æ”¯æŒ `64` æˆ– `128`ã€‚ |
| `-f`, `--fuzzy` | âŒ | 1 | æ¨¡ç³Šåº¦ (F value)ã€‚æ”¯æŒ 1, 2, 3, 4ã€‚ |
| `-l`, `--length` | âŒ | 1800 | æœ€å°åŒ¹é…é•¿åº¦é˜ˆå€¼ã€‚å¿…é¡»å¤§äº 2B-1ã€‚ |
| `-s`, `--stats` | âŒ | `<output>.inf` | ç»Ÿè®¡ä¿¡æ¯è¾“å‡ºæ–‡ä»¶è·¯å¾„ã€‚ |
| `-h`, `--help` | - | - | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ã€‚ |

### è¿è¡Œç¤ºä¾‹

#### 1. å¤„ç† VCF æ–‡ä»¶ (é»˜è®¤æ¨¡å¼)

è¿›è¡Œé¢æ¿å†…è‡ªæŸ¥è¯¢ï¼ŒæŸ¥æ‰¾é•¿åº¦å¤§äº 2000 ä¸ªä½ç‚¹çš„å…±äº«ç‰‡æ®µï¼š

```bash
./wild-multiFSPBWT -i data/chr1.vcf -o results/chr1.matches -l 2000

```

#### 2. å¤„ç† MACS æ¨¡æ‹Ÿæ•°æ® (Out-Panel æ¨¡å¼)

å°† `query.macs` ä¸ `ref.macs` è¿›è¡Œæ¯”å¯¹ï¼Œä½¿ç”¨ 128 ä½å—å¤§å°åŠ é€Ÿï¼š

```bash
./wild-multiFSPBWT -i data/ref.macs -q data/query.macs \
                   -o results/query_match.txt \
                   -m out --macs -B 128 -l 1000

```

## ğŸ“„ è¾“å…¥æ–‡ä»¶æ ¼å¼

### 1. VCF æ ¼å¼ (é»˜è®¤)

æ ‡å‡†çš„ Variant Call Formatã€‚ç¨‹åºä¼šè‡ªåŠ¨è·³è¿‡ä»¥ `##` å¼€å¤´çš„å…ƒæ•°æ®è¡Œå’Œä»¥ `#` å¼€å¤´çš„è¡¨å¤´è¡Œã€‚

* ç¨‹åºè¯»å–ç¬¬ 10 åˆ—åŠä»¥åçš„åŸºå› å‹æ•°æ®ã€‚
* æ”¯æŒ `0`, `1`, `.` (ç¼ºå¤±), ä»¥åŠ `2`-`9` (å¤šç­‰ä½)ã€‚
* åˆ†éš”ç¬¦å¿…é¡»ä¸ºåˆ¶è¡¨ç¬¦ `\t`ã€‚

### 2. MACS æ ¼å¼ (`--macs`)

MACS æ¨¡æ‹Ÿå™¨çš„è¾“å‡ºæ ¼å¼ã€‚ç¨‹åºæŸ¥æ‰¾ä»¥ `SITE:` å¼€å¤´çš„è¡Œã€‚
æ ¼å¼ç¤ºä¾‹ï¼š

```text
SITE:  0  100  A  0101100...
SITE:  1  200  C  1110000...

```

* å­—æ®µ 5 åŒ…å«æ‰€æœ‰æ ·æœ¬åœ¨è¯¥ä½ç‚¹çš„å•å€å‹å­—ç¬¦ä¸²ã€‚

## ğŸ“ è¾“å‡ºç»“æœ

### åŒ¹é…ç»“æœæ–‡ä»¶ (`-o`)

æ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªåŒ¹é…çš„é•¿ç‰‡æ®µï¼Œæ ¼å¼å¦‚ä¸‹ï¼š

```text
ID1    ID2    Start_Index    End_Index

```

* `ID1`: Panel ä¸­çš„æ ·æœ¬ ID (æˆ– Query ID)ã€‚
* `ID2`: åŒ¹é…å¯¹è±¡çš„ IDã€‚
* `Start_Index`: åŒ¹é…ç‰‡æ®µçš„èµ·å§‹ä½ç‚¹ç´¢å¼•ã€‚
* `End_Index`: åŒ¹é…ç‰‡æ®µçš„ç»“æŸä½ç‚¹ç´¢å¼•ã€‚

### ç»Ÿè®¡ä¿¡æ¯æ–‡ä»¶ (`-s`)

åŒ…å«è¿è¡Œæ—¶é—´ã€ç®—æ³•å‚æ•° ()ã€ä½ç‚¹ç»Ÿè®¡ï¼ˆ0/1/ç¼ºå¤±/å¤šç­‰ä½æ•°é‡ï¼‰ä»¥åŠå‘ç°çš„åŒ¹é…æ€»æ•°ç­‰è¯¦ç»†ä¿¡æ¯ã€‚



## ğŸ“œ è®¸å¯è¯ä¸å¼•ç”¨ (License & Citation)

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) å¼€æºæˆæƒã€‚

å¦‚æœæ‚¨åœ¨ç ”ç©¶ä¸­ä½¿ç”¨äº†æœ¬é¡¹ç›®çš„ä»£ç æˆ–ç®—æ³•ï¼Œ**è¯·åŠ¡å¿…å¼•ç”¨ä»¥ä¸‹è®ºæ–‡**ï¼ˆæ”¯æŒåŸæœ¬çš„å­¦æœ¯æˆæœï¼‰ï¼š

> **[è¿™é‡Œå†™ä½ çš„è®ºæ–‡æ ‡é¢˜]**
> *Authors: [ä½ çš„åå­—], [å¯¼å¸ˆåå­—], et al.*
> *Journal/Conference: [æœŸåˆŠæˆ–ä¼šè®®åç§°], Year.*
> *DOI: [è®ºæ–‡é“¾æ¥æˆ–DOI]*

BibTeX:
```bibtex
@article{YourName2026FSPBWT,
  title={Research and Application of Haplotype Long-Match Query Algorithm Based on PBWT},
  author={Your Name and Co-authors},
  journal={Journal Name},
  year={2026},
  publisher={Publisher}
}
